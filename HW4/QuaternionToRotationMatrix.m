function R = QuaternionToRotationMatrix(Q)
%% Q is a 1x1 vector and is defined as Q = [qi, qj, qk, q0]

R = [   Q(4)*Q(4) + Q(1)*Q(1) - Q(2)*Q(2) - Q(3)*Q(3), ...
        2 * (Q(1)*Q(2) - Q(4)*Q(3)), ...
        2 * (Q(1)*Q(3) + Q(4)*Q(2));

        2 * (Q(1)*Q(2) + Q(4)*Q(3)), ...
        Q(4)*Q(4) - Q(1)*Q(1) + Q(2)*Q(2) - Q(3)*Q(3), ...
        2 * (Q(2)*Q(3) - Q(4)*Q(1));

        2 * (Q(1)*Q(3) - Q(4)*Q(2)), ...
        2 * (Q(2)*Q(3) + Q(4)*Q(1)), ...
        Q(4)*Q(4) - Q(1)*Q(1) - Q(2)*Q(2) + Q(3)*Q(3)   ];